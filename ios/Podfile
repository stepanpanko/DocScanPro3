# -- RN Pods bootstrap (pnpm-safe & CI-safe) -------------------------------

# Find react-native inside node_modules no matter how pnpm lays it out.
rn_dir = Dir.glob(File.expand_path('../node_modules/**/react-native', __dir__))
           .find { |p| File.exist?(File.join(p, 'scripts', 'react_native_pods.rb')) }
abort('React Native not installed (react_native_pods.rb not found)') unless rn_dir

require File.join(rn_dir, 'scripts', 'react_native_pods.rb')

platform :ios, '15.4'
prepare_react_native_project!

# Optional: export USE_FRAMEWORKS=static|dynamic in CI/local if you need it
linkage = ENV['USE_FRAMEWORKS']
if linkage && !linkage.empty?
  Pod::UI.puts "Configuring CocoaPods with #{linkage}ally linked frameworks".green
  use_frameworks! linkage: linkage.to_sym
end

target 'DocScanPro3Temp' do
  config = use_native_modules!

  use_react_native!(
    path: config[:reactNativePath],
    # absolute path so running pod install from ios/ works
    app_path: "#{Pod::Config.instance.installation_root}/.."
  )

  post_install do |installer|
    react_native_post_install(
      installer,
      config[:reactNativePath],
      mac_catalyst_enabled: false
    )
  end
end