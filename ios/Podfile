# -- RN Pods bootstrap (pnpm/CI safe, no env needed) -------------------------
project_root = File.expand_path('..', __dir__)

# Ask Node to resolve the real path to react_native_pods.rb from project root
rn_scripts = Pod::Executable.execute_command(
  'node',
  [
    '-e',
    # Use createRequire to resolve from the app root (not ios/)
    "const { createRequire } = require('module');" \
    "const path = require('path');" \
    "const req = createRequire(path.join(process.argv[2], 'package.json'));" \
    "console.log(req.resolve('react-native/scripts/react_native_pods.rb'));",
    project_root
  ]
).strip

raise 'react_native_pods.rb not found' if rn_scripts.nil? || rn_scripts.empty?
require rn_scripts

platform :ios, '15.4'
prepare_react_native_project!

# Optional: export USE_FRAMEWORKS=static|dynamic if you need it
linkage = ENV['USE_FRAMEWORKS']
if linkage && !linkage.empty?
  Pod::UI.puts "Configuring CocoaPods with #{linkage}ally linked frameworks".green
  use_frameworks! linkage: linkage.to_sym
end

target 'DocScanPro3Temp' do
  config = use_native_modules!

  use_react_native!(
    path: config[:reactNativePath],
    app_path: "#{Pod::Config.instance.installation_root}/.."
  )

  post_install do |installer|
    react_native_post_install(
      installer,
      config[:reactNativePath],
      mac_catalyst_enabled: false
    )
  end
end