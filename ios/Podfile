# -- RN Pods bootstrap (pnpm/CI safe) ---------------------------------------

# Prefer path passed from CI/local via RN_SCRIPTS; fall back to a glob search.
rn_scripts = ENV['RN_SCRIPTS']
if rn_scripts.nil? || rn_scripts.empty?
  rn_dir = Dir.glob(File.expand_path('../node_modules/**/react-native', __dir__))
             .find { |p| File.exist?(File.join(p, 'scripts', 'react_native_pods.rb')) }
  abort('React Native not installed (react_native_pods.rb not found)') unless rn_dir
  rn_scripts = File.join(rn_dir, 'scripts', 'react_native_pods.rb')
end

require rn_scripts

platform :ios, '15.4'
prepare_react_native_project!

# Optional linkage: export USE_FRAMEWORKS=static|dynamic to override
linkage = ENV['USE_FRAMEWORKS']
if linkage && !linkage.empty?
  Pod::UI.puts "Configuring CocoaPods with #{linkage}ally linked frameworks".green
  use_frameworks! linkage: linkage.to_sym
end

target 'DocScanPro3Temp' do
  config = use_native_modules!

  use_react_native!(
    path: config[:reactNativePath],
    app_path: "#{Pod::Config.instance.installation_root}/.."
  )

  post_install do |installer|
    react_native_post_install(
      installer,
      config[:reactNativePath],
      mac_catalyst_enabled: false
    )
  end
end